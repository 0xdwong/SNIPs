---
snip: 15
title: 只有账户可以调用其 `execute`
description: 本 SNIP 提议限制对账户 `execute` 方法的调用，仅允许外部调用和来自账户自身的调用。
author: Ilia Volokh <iliav@starkware.co>
discussions-to: https://community.starknet.io/t/snip-15-only-an-account-can-call-its-execute/114444
status: Review
type: Standards Track
category: Core
created: 2024-07-01
---

## 简要总结
限制 Starknet 使得只有账户可以调用自己的 `execute` 函数，防止其他合约的内部调用。

## 摘要

本提案定义了一项将在账户的 `execute` 入口点上施加的协议级别限制。该限制要求调用者地址必须等于相关账户的 `execute` 地址。

## 动机

用户通过其账户通过 `execute` 入口点进行操作。能够访问某人账户的 `execute` 相当于代表他们行事。

目前的现状是，所有安全账户实现都在其 `execute` 入口点中明确包含一行代码，强制要求调用不是内部调用。没有这一行的账户则容易被他人代表其行事。

## 规范

执行客户端将跟踪调用者地址，并在调用 `execute` 入口点时，如果调用者地址不是相关账户，则立即失败该交易。

操作系统将强制执行这一限制，使任何违反该限制的调用无法证明。

## 理由

我们认为默认行为应保护天真的用户和开发者免受这种反直觉的漏洞的影响，该漏洞允许任何人代表他人的账户行事。

## 缺点

所提议的限制将破坏任何从代理合约调用账户 `execute` 的应用流程。

在最近的历史中，已经有数十笔交易具有这种流程。在引入限制后，这些交易将被回滚（特别是，它们的发送者将支付费用）。

在我们看来，这一缺点是可以接受的，因为合约代表账户行事的流程是可能的，例如通过 SNIP 9（“外部执行”）。

## 向后兼容性

本提案将破坏任何涉及对账户 `execute` 方法的外部内部调用的流程。

## 安全考虑

本提案旨在通过减轻账户编写者防止对 `execute` 的外部内部调用的责任来提高安全性。一般来说，我们希望给予账户编写者自由。然而，在这种情况下，我们认为开发者对外部控制账户威胁的无知所带来的后果证明了协议级别限制的必要性。

## 版权

版权及相关权利通过 [MIT](../LICENSE) 放弃。