---
snip: 16
title: 废弃交易版本 0,1,2
description: 本 SNIP 提议废弃交易版本 0,1,2，并在 2025 年第一季度末停止对它们的支持。
author: Ilia Volokh <iliav@starkware.co>
discussions-to: https://community.starknet.io/t/snip-16-deprecation-of-transaction-versions-0-1-2/114443
status: Review
type: Standards Track
category: Core
created: 2024-07-02
---

## 简要总结
在费用市场的背景下，交易版本 0,1,2 较交易版本 3 较差且不兼容：它们支持不同的费用代币，并且出价结构较差。

我们提议废弃交易版本 0,1,2，并在内存池在排序器中实现后停止对它们的支持。

## 动机

排序器目前以 FIFO 处理交易。在拥堵时，区块空间变得稀缺。为了改善用户体验，Starknet 将拥有一个费用市场，允许用户表达价值和时间偏好。

交易版本 3 是在考虑 1559 类型费用市场的情况下引入的。首先，它便于使用 STRK 进行费用支付，STRK 被指定为唯一的本地费用代币。其次，它的出价结构以每单位资源的价格命名，使排序器能够轻松比较出价。

交易版本 0,1,2 仅支持以 ETH 支付费用。此外，它们的出价结构较差，导致排序器在经济计算中效率低下。具体而言，用户提交一个最大费用，但并未直接指定每单位资源的最大费用或最大金额。无法从最大费用中推导出这两个数字。因此，无法智能地将用户的出价分解为“基础”费用和“小费”。

## 提议

我们提议排序器在即将发布的版本中停止对交易版本 0,1,2 的支持，以准备集成内存池和费用市场，预计将在 6-8 个月内实现。具体而言，我们提议在内存池的网关拒绝这些交易版本。

为了方便继续以 ETH 支付费用，我们提议采用支付管理器。应用程序/钱包将决定使用 AVNU 等应用支付管理器还是协议级支付管理器。（关于协议级支付管理器的详细 SNIP 正在制定中。）

## 理由
我们认为支付管理器是支持多种费用代币的正确解决方案。因此，没有理由为继续支持旧交易版本而设计复杂的解决方案。

## 缺点

1. 交易版本 0,1,2 便于以 ETH 进行本地费用支付。它们的废弃意味着 ETH 将不再是本地费用代币。

2. 目前，大部分交易以 ETH 支付费用。因此，大部分需求将不得不通过不同的费用支付流程，可能需要钱包的更改，并且（根据支付管理器的采用方式）可能还需要 DApp 和基础设施（SDK）的更改。

3. 旧账户，即在 `validate` 和 `execute` 分离之前创建的账户，仅能通过交易版本 v0 访问。因此，废弃此交易版本将使所有此类账户（及其资产）无法访问。我们将在单独的 SNIP 中解决此问题。

## 替代方案

以下是一些替代提议及我们反对它们的理由。

1. 为交易版本 ≤2 保留但逐渐减少的区块空间，并临时支持指定的 FIFO 队列。

2. 同时在支付 ETH 和 STRK 的交易上进行费用市场，排序器承担 ETH↔STRK 转换。请注意，如何为交易版本 0,1,2 实现费用市场尚不清楚，因为仅根据最大费用排序忽略了交易所消耗的计算资源。

## 向后兼容性
该提议终止了当前支持的发送交易版本 0,1,2 的流程。此外，需要单独的提议来解决对旧账户的访问。

## 安全考虑
该提议不引入漏洞，但需要单独讨论在 `validate` 和 `execute` 分离之前的账户。

## 版权

版权及相关权利通过 [MIT](../LICENSE) 放弃。